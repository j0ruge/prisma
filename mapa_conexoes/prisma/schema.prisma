// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Device {
  id                  String               @id @default(uuid())
  name                String
  type                String
  DeviceConectors     DeviceConector[]
  DeviceManufacturers DeviceManufacturer[]
  source_conection    Conection[] @relation("source_conection")
  destination_conection    Conection[] @relation("destination_conection")

  @@map("devices")
}

model DeviceManufacturer {
  id             String       @id @default(uuid())
  device         Device       @relation(fields: [deviceId], references: [id])
  manufacturer   Manufacturer @relation(fields: [manufacturerId], references: [id])
  deviceId       String
  manufacturerId String

  @@map("device_manufacturers")
}

model Manufacturer {
  id   String @id @default(uuid())
  name String

  DeviceManufacturers DeviceManufacturer[]

  @@map("manufacturers")
}

model DeviceConector {
  id         String   @id @default(uuid())
  device     Device   @relation(fields: [deviceId], references: [id])
  conector   Conector @relation(fields: [conectorId], references: [id])
  deviceId   String
  conectorId String   @map("conectorId")

  @@map("device_conectors")
}

model Conector {
  id            String @id @default(uuid())
  number        String
  channel_type  String
  conector_type String

  DeviceConectors DeviceConector[]

  @@map("conectors")
}

model Conection {
  id                   String @id @default(uuid())
  source_device_id     String @map("source_device_id")
  destination_device_id String @map("destination_device_id")


  source_device               Device @relation("source_device",fields: [source_device_id], references: [id])
  destination_device          Device @relation("destination_device",fields: [destination_device_id], references: [id])
  //destination_device     Device @relation(fields: [destination_device_id], references: [id])
  //source_device      Device @relation(fields: [deviceId], references: [id])
  //conector    Conector @relation(fields: [conectorId], references: [id])
  
  //conectorId  String @map("conectorId")

  @@map("conections")
}
